{
  "apiVersion": "batch/v1",
  "kind": "Job",
  "metadata": {
    "annotations": {
      "helm.sh/hook": "pre-install, pre-upgrade"
    },
    "labels": {
      "app.kubernetes.io/instance": "eg",
      "app.kubernetes.io/managed-by": "Helm",
      "app.kubernetes.io/name": "gateway-helm",
      "app.kubernetes.io/version": "latest",
      "helm.sh/chart": "gateway-helm-v0.0.0-latest",
      "k8s.joshcorp.co/app": "ingress"
    },
    "name": "eg-gateway-helm-certgen",
    "namespace": "envoy-gateway-system"
  },
  "spec": {
    "backoffLimit": 1,
    "completions": 1,
    "parallelism": 1,
    "template": {
      "metadata": {
        "labels": {
          "app": "certgen"
        }
      },
      "spec": {
        "containers": [
          {
            "command": [
              "envoy-gateway",
              "certgen"
            ],
            "env": [
              {
                "name": "ENVOY_GATEWAY_NAMESPACE",
                "valueFrom": {
                  "fieldRef": {
                    "apiVersion": "v1",
                    "fieldPath": "metadata.namespace"
                  }
                }
              },
              {
                "name": "KUBERNETES_CLUSTER_DOMAIN",
                "value": "cluster.local"
              }
            ],
            "image": "envoyproxy/gateway:v1.1.2",
            "imagePullPolicy": "IfNotPresent",
            "name": "envoy-gateway-certgen"
          }
        ],
        "imagePullSecrets": [],
        "restartPolicy": "Never",
        "securityContext": {
          "runAsGroup": 65534,
          "runAsNonRoot": true,
          "runAsUser": 65534
        },
        "serviceAccountName": "eg-gateway-helm-certgen"
      }
    },
    "ttlSecondsAfterFinished": 30
  }
}
